#!/bin/sh

cat >/etc/systemd/network/01-eth0.network <<EOF
[Match]
Name=eth0 eno1

[Network]
LLDP=true
EmitLLDP=nearest-bridge

[Address]
Address={{ index .Spec.IPv4 1 }}/{{ (index .Info.Network.IPv4 1).MaskBits }}
Scope=link
EOF

cat >/etc/systemd/network/01-eth1.network <<EOF
[Match]
Name=eth1 eno2

[Network]
LLDP=true
EmitLLDP=nearest-bridge

[Address]
Address={{ index .Spec.IPv4 2 }}/{{ (index .Info.Network.IPv4 2).MaskBits }}
Scope=link
EOF

systemctl restart systemd-networkd.service
