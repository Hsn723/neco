Artifacts
=========

Artifacts `artifacts.go` is a collection of components which are tested by [dctest](../dctest/).
It is given as a go file with structs, and is compiled into neco binaries.
See [types.go](../types.go) for details of structs.

**This file is generated by `generate-artifacts` command. PLEASE DO NOT EDIT MANUALLY**

There are two artifacts files.

- [artifacts.go](../artifacts.go)

    This file is for developers to define the set of artifacts to be tested.
    Developers may update this file anytime by using `generate-artifacts`
    or by editing manually.

- [artifacts_release.go](../artifacts.go)

    This file is for CI.  The CI job updates this file by using
    `generate-artifacts --release`.

    The developers are PROHIBITED to modify this file.  This is to prevent
    merge conflicts in CI flow.

    This file exists only in the `release` branch.

When generating neco binaries and the neco deb package, `artifacts.go` is used
in default.  A CI job uses `artifacts_release.go` by specifying `TAGS=release`
for `make` command after checking-out the `release` branch.

## How to handle prerelease versions

As described above, you should not edit artifacts files manually in general.
One of the exceptions is to use an RC version of a component, e.g. cke 1.15.0-rc1,
to prepare for the update of the component.
A component with prerelease version information, i.e. x.y.z-\<prerelease\>,
does not get included in artifacts files by `generate-artifacts`.
So if you want to use such a component, include it manually.
Though you can edit `artifacts.go` in this case, you must not merge it into
the master branch anyway, because that component does not get included in
`artifacts_release.go` and CI on `release` branch will fail.
Instead, after you confirm that neco can accept a component of x.y.z-\<prerelease\>,
release the component as x.y.z and include it in artifacts files by `generate-artifacts`.

## How to ignore latest versions

By using `artifacts_ignore.yaml`, the latest versions of components can be ignored.
Use this, for example, if you have a bug in the latest versions and do not want to include it in `artifacts.go`.

```yaml
images:
- name: cke
  versions: ["1.2.3", "1.2.4", "1.2.5"]
- name: etcd
  versions: ["1.2.3.4"]
debs:
- name: etcdpasswd
  versions: ["v1.2.3"]
coreOS:
- channel: stable
  versions: ["2247.5.0"]
```
